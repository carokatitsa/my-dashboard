<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>My Opening Trainer</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/chess.js/0.10.3/chess.min.js"></script>

<style>
body {
  font-family: Arial;
}

#board {
  display: grid;
  grid-template-columns: repeat(8, 60px);
  grid-template-rows: repeat(8, 60px);
  width: 480px;
  border: 2px solid black;
}

.square {
  width: 60px;
  height: 60px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 40px;
  cursor: pointer;
}

.white { background: #f0d9b5; }
.black { background: #b58863; }

.selected {
  background: yellow !important;
}

button {
  margin: 10px 5px 10px 0;
  padding: 6px 12px;
}
</style>
</head>

<body>

<h2>Opening Trainer</h2>

<button onclick="playOpening()">Play My Opening</button>
<button onclick="resetBoard()">Reset</button>

<div id="board"></div>

<script>
var game = new Chess();
var selectedSquare = null;

function renderBoard() {
  var boardDiv = document.getElementById("board");
  boardDiv.innerHTML = "";

  var position = game.board();

  for (var row = 0; row < 8; row++) {
    for (var col = 0; col < 8; col++) {

      var square = document.createElement("div");
      square.classList.add("square");

      if ((row + col) % 2 === 0) {
        square.classList.add("white");
      } else {
        square.classList.add("black");
      }

      var piece = position[row][col];

      if (piece) {
        square.textContent = getPieceSymbol(piece);
      }

      var squareName = getSquareName(row, col);
      square.dataset.square = squareName;

      square.addEventListener("click", onSquareClick);

      boardDiv.appendChild(square);
    }
  }
}

function getSquareName(row, col) {
  var files = "abcdefgh";
  return files[col] + (8 - row);
}

function getPieceSymbol(piece) {
  var symbols = {
    p: "♟",
    r: "♜",
    n: "♞",
    b: "♝",
    q: "♛",
    k: "♚"
  };

  return piece.color === "w"
    ? symbols[piece.type].toUpperCase()
    : symbols[piece.type];
}

function onSquareClick(e) {
  var square = e.currentTarget.dataset.square;

  if (!selectedSquare) {
    selectedSquare = square;
  } else {
    var move = game.move({
      from: selectedSquare,
      to: square,
      promotion: "q"
    });

    if (!move) {
      alert("Illegal move");
    }

    selectedSquare = null;
    renderBoard();
  }
}

function playOpening() {
  var moves = ['d4','d5','c4','e6','Nf3','Nf6','g3'];

  game.reset();

  moves.forEach(function(move) {
    game.move(move);
  });

  renderBoard();
}

function resetBoard() {
  game.reset();
  renderBoard();
}

renderBoard();
</script>

</body>
</html>

